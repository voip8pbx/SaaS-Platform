{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///D:/NEXT.js/SuperAdmin/src/app/api/config/route.ts"],"sourcesContent":["import { NextResponse, NextRequest } from 'next/server';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { pipeline } from 'stream';\r\nimport { promisify } from 'util';\r\n\r\nconst pump = promisify(pipeline);\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const formData = await req.formData() as any;\r\n\r\n        // Read existing file content first to support partial updates (preservation)\r\n        const targetPath = 'd:\\\\NEXT.js\\\\SuperAdmin\\\\templates\\\\TravelPlannerWebsite\\\\src\\\\config\\\\siteConfig.ts';\r\n        let existingContent = '';\r\n        if (fs.existsSync(targetPath)) {\r\n            try {\r\n                existingContent = fs.readFileSync(targetPath, 'utf8');\r\n            } catch (e) { /* ignore */ }\r\n        }\r\n\r\n        // Helper to extract value from existing content\r\n        const getExisting = (key: string, defaultVal: string = '') => {\r\n            const match = existingContent.match(new RegExp(`${key}:\\\\s*[\\`\"]([^\\`\"]*)[\\`\"]`));\r\n            return match ? match[1] : defaultVal;\r\n        };\r\n\r\n        const getExistingContent = (key: string) => {\r\n            const match = existingContent.match(new RegExp(`${key}:\\\\s*\\`([^\\`]*)\\``));\r\n            if (match) return match[1];\r\n            const matchQuote = existingContent.match(new RegExp(`${key}:\\\\s*\"([^\"]*)\"`));\r\n            return matchQuote ? matchQuote[1] : '';\r\n        };\r\n        const name = formData.get('name') as string;\r\n        const description = formData.get('description') as string;\r\n\r\n        const adminUserIdInput = formData.get('adminUserId');\r\n        const adminUserId = adminUserIdInput !== null ? adminUserIdInput as string : getExisting('adminUserId');\r\n\r\n        const featuresStr = formData.get('features') as string;\r\n        const logoFile = formData.get('logoFile') as File | null;\r\n        const logoPathRaw = formData.get('logoPath') as string;\r\n        const primaryColor = formData.get('primaryColor') as string;\r\n        const theme = formData.get('theme') as string;\r\n        const layout = formData.get('layout') as string;\r\n        const heroImage = formData.get('heroImage') as string;\r\n\r\n        // Admin Content Fields\r\n        const contactPhone = formData.get('contact_phone') !== null ? formData.get('contact_phone') as string : getExisting('phone', '+1 (555) 123-4567');\r\n        const contactEmail = formData.get('contact_email') !== null ? formData.get('contact_email') as string : getExisting('email', 'support@travelpanner.com');\r\n        const contactAddress = formData.get('contact_address') !== null ? formData.get('contact_address') as string : getExisting('address', '123 Travel Street, Cloud City, TC 90210');\r\n\r\n        const socialTwitter = formData.get('social_twitter') !== null ? formData.get('social_twitter') as string : getExisting('twitter', 'https://twitter.com/travelpanner');\r\n        const socialFacebook = formData.get('social_facebook') !== null ? formData.get('social_facebook') as string : getExisting('facebook', 'https://facebook.com/travelpanner');\r\n        const socialInstagram = formData.get('social_instagram') !== null ? formData.get('social_instagram') as string : getExisting('instagram', 'https://instagram.com/travelpanner');\r\n        const socialLinkedin = formData.get('social_linkedin') !== null ? formData.get('social_linkedin') as string : getExisting('linkedin', 'https://linkedin.com/company/travelpanner');\r\n\r\n        const contentAboutUs = formData.get('content_aboutUs') !== null ? formData.get('content_aboutUs') as string : getExistingContent('aboutUs');\r\n        const contentCareer = formData.get('content_career') !== null ? formData.get('content_career') as string : getExistingContent('career');\r\n        const contentBlog = formData.get('content_blog') !== null ? formData.get('content_blog') as string : getExistingContent('blog');\r\n\r\n        const features = JSON.parse(featuresStr || '{}');\r\n\r\n        let logoUrl = logoPathRaw || '';\r\n\r\n        // Handle File Upload\r\n        if (logoFile && logoFile.size > 0) {\r\n            const buffer = Buffer.from(await logoFile.arrayBuffer());\r\n            const fileName = `logo-${Date.now()}${path.extname(logoFile.name)}`;\r\n            // Save to Template's public folder\r\n            const uploadDir = 'd:\\\\NEXT.js\\\\SuperAdmin\\\\templates\\\\TravelPlannerWebsite\\\\public\\\\uploads';\r\n\r\n            if (!fs.existsSync(uploadDir)) {\r\n                fs.mkdirSync(uploadDir, { recursive: true });\r\n            }\r\n\r\n            const filePath = path.join(uploadDir, fileName);\r\n            fs.writeFileSync(filePath, buffer);\r\n\r\n            logoUrl = `/uploads/${fileName}`;\r\n        } else if (!logoUrl) {\r\n            logoUrl = getExisting('logo');\r\n        }\r\n\r\n        // Target path is already defined at start of function\r\n\r\n\r\n        // Construct the file content\r\n        const fileContent = `export const siteConfig = {\r\n    name: \"${name}\",\r\n    adminUserId: \"${adminUserId}\",\r\n    description: \"${description}\",\r\n    logo: \"${logoUrl}\",\r\n    primaryColor: \"${primaryColor || '#3b82f6'}\",\r\n    ${(() => {\r\n                let customColorsBlock = `customColors: {\r\n        background: \"\",\r\n        header: \"\"\r\n    }`;\r\n                if (fs.existsSync(targetPath)) {\r\n                    try {\r\n                        const existing = fs.readFileSync(targetPath, 'utf8');\r\n                        const match = existing.match(/customColors:\\s*\\{[\\s\\S]*?\\}(?=\\,\\s*theme:)/);\r\n                        if (match) customColorsBlock = match[0];\r\n                    } catch (e) { /* ignore */ }\r\n                }\r\n                return customColorsBlock;\r\n            })()},\r\n    theme: \"${theme || 'light'}\",\r\n    layout: \"${layout || 'classic'}\",\r\n    heroImage: \"${heroImage || 'https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=2074&auto=format&fit=crop'}\",\r\n    features: {\r\n        flights: ${features.flights !== undefined ? features.flights : true},\r\n        packages: ${features.packages !== undefined ? features.packages : true},\r\n        hotels: ${features.hotels !== undefined ? features.hotels : true},\r\n        trains: ${features.trains !== undefined ? features.trains : true},\r\n        cabs: ${features.cabs !== undefined ? features.cabs : true},\r\n        rentals: ${features.rentals !== undefined ? features.rentals : true},\r\n        cars: ${features.cars || false},\r\n        aiPlanner: ${features.aiPlanner || false},\r\n        cruises: ${features.cruises !== undefined ? features.cruises : true},\r\n        villas: ${features.villas !== undefined ? features.villas : true},\r\n        news: ${features.news !== undefined ? features.news : true}\r\n    },\r\n    contact: {\r\n        phone: \"${contactPhone || '+1 (555) 123-4567'}\",\r\n        email: \"${contactEmail || 'support@travelpanner.com'}\",\r\n        address: \"${contactAddress || '123 Travel Street, Cloud City, TC 90210'}\"\r\n    },\r\n    social: {\r\n        twitter: \"${socialTwitter || 'https://twitter.com/travelpanner'}\",\r\n        facebook: \"${socialFacebook || 'https://facebook.com/travelpanner'}\",\r\n        instagram: \"${socialInstagram || 'https://instagram.com/travelpanner'}\",\r\n        linkedin: \"${socialLinkedin || 'https://linkedin.com/company/travelpanner'}\"\r\n    },\r\n    content: {\r\n        aboutUs: \\`${contentAboutUs || ''}\\`,\r\n        career: \\`${contentCareer || ''}\\`,\r\n        blog: \\`${contentBlog || ''}\\`\r\n    },\r\n    currency: {\r\n        code: \"USD\", // default\r\n        symbol: \"$\" // default\r\n    }\r\n};\r\n\r\nexport type SiteConfig = typeof siteConfig;\r\n`;\r\n\r\n        fs.writeFileSync(targetPath, fileContent, 'utf-8');\r\n\r\n        return NextResponse.json({ success: true, message: 'Configuration updated successfully' });\r\n    } catch (error) {\r\n        console.error('Error updating config:', error);\r\n        return NextResponse.json({ success: false, error: 'Failed to update configuration' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function GET() {\r\n    try {\r\n        const targetPath = 'd:\\\\NEXT.js\\\\SuperAdmin\\\\templates\\\\TravelPlannerWebsite\\\\src\\\\config\\\\siteConfig.ts';\r\n        if (!fs.existsSync(targetPath)) {\r\n            return NextResponse.json({ success: false, error: 'Config file not found' }, { status: 404 });\r\n        }\r\n\r\n        const fileContent = fs.readFileSync(targetPath, 'utf8');\r\n\r\n        // Very basic parsing to extract values - this is brittle but avoids eval\r\n        // A robust solution would use an AST parser\r\n        const extract = (key: string) => {\r\n            const match = fileContent.match(new RegExp(`${key}:\\\\s*\"([^\"]*)\"`));\r\n            return match ? match[1] : '';\r\n        };\r\n\r\n        const extractBool = (key: string) => {\r\n            const match = fileContent.match(new RegExp(`${key}:\\\\s*(true|false)`));\r\n            return match ? match[1] === 'true' : false;\r\n        };\r\n\r\n        // For features which are nested\r\n        const features = {\r\n            flights: extractBool('flights'),\r\n            packages: extractBool('packages'),\r\n            hotels: extractBool('hotels'),\r\n            trains: extractBool('trains'),\r\n            cabs: extractBool('cabs'),\r\n            rentals: extractBool('rentals'),\r\n            cars: extractBool('cars'),\r\n            aiPlanner: extractBool('aiPlanner'),\r\n            cruises: extractBool('cruises'),\r\n            villas: extractBool('villas'),\r\n            news: extractBool('news'),\r\n        };\r\n\r\n        const config = {\r\n            name: extract('name'),\r\n            description: extract('description'),\r\n            logo: extract('logo'),\r\n            adminUserId: extract('adminUserId'),\r\n            primaryColor: extract('primaryColor'),\r\n            theme: extract('theme'),\r\n            layout: extract('layout'),\r\n            heroImage: extract('heroImage'),\r\n            features,\r\n            contact: {\r\n                phone: extract('phone'),\r\n                email: extract('email'),\r\n                address: extract('address'),\r\n            },\r\n            social: {\r\n                twitter: extract('twitter'),\r\n                facebook: extract('facebook'),\r\n                instagram: extract('instagram'),\r\n                linkedin: extract('linkedin'),\r\n            },\r\n            content: {\r\n                aboutUs: fileContent.match(/aboutUs:\\s*`([^`]*)`/)?.[1] || '',\r\n                career: fileContent.match(/career:\\s*`([^`]*)`/)?.[1] || '',\r\n                blog: fileContent.match(/blog:\\s*`([^`]*)`/)?.[1] || '',\r\n            }\r\n        };\r\n\r\n        return NextResponse.json(config);\r\n    } catch (error) {\r\n        console.error('Error reading config:', error);\r\n        return NextResponse.json({ success: false, error: 'Failed to read configuration' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}